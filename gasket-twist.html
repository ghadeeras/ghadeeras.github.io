<!doctype html>
<html>

  <head>
    <meta charset="utf-8">
  
    <title>Gasket Twist</title>
    
    <style>
    
      body {
        background-color: grey;
      }
      
      canvas {
        width: 512px;
        height: 512px;
      }
      
      .panel {
        float: left;
        background-color: lightgrey;
        margin: 8px;
      }
      
      .panel.center {
        width: 512px;
        height: 512px;
      }

      .panel.right {
        width: 384px;
        height: 512px;
      }
      
    </style>
    
    <script id="shader-vertex" type="x-shader/x-vertex">
      attribute vec2 vPosition;
      
      uniform float twist;
      uniform float scale;
      
      void main() {
        vec2 p = scale * vPosition;
        float angle = twist * length(p);
        float s = sin(angle);
        float c = cos(angle);
        mat2 rotation = mat2(vec2(c, s), vec2(-s, c));
        gl_Position = vec4(rotation * p, 0.0, 1.0);
      }
    </script>

    <script id="shader-fragment" type="x-shader/x-fragment">
      precision mediump float;
      
      void main() {
        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0);
      }
    </script>
    
    <script src="./webgl.js" type="text/javascript"></script>
    <script src="./gasket-twist.js" type="text/javascript"></script>
    
  </head>
  
  <body onload="init()">
    <div>
      <div class="center panel">
        <canvas id="canvas-gl" width="512" height="512" onmousemove="move(event)" onmousedown="move(event)">
          Your browser seems not to support HTML 5 Canvas!
        </canvas>
      </div>
      <div class="right panel">
        <p>
          <input id="input-corners" name="input-corners" type="checkbox" checked="checked" onchange="redraw(event)" />
          <b>Fractal edge</b>:
          Checking this option will render the "edge" of the fractal, or rather the sub-triangles at the corners of each divided triangle. 
        </p>
        <p>
          <input id="input-centers" name="input-centers" type="checkbox" checked="checked" onchange="redraw(event)" />
          <b>Fractal enterior</b>:
          Checking this option will render the "enterior" of the fractal, or rather the subtriangles at the centers of each divided triangle.
        </p>
        <p>
          <b>Recursive division depth</b>: 
          <button id="division-inc" onclick="incDivision(event)">+</button>
          <span id="division-depth">8</span>
          <button id="division-dec" onclick="decDivision(event)">-</button>
        </p>
        <p>
          <div>
            <input id="input-scale" name="input-scale" type="checkbox" checked="checked" />
            <b>Scale = <span id="scale">1.0</span></b>
          </div>
          If checked, moving the mouse pointer "vertically" over the canvas while holding down the mouse button 
          will change the amount of scaling applied on the rendered shape.
          Scaling is applied before twisting.
        </p>
        <p>
          <div>
            <input id="input-twist" name="input-twist" type="checkbox" checked="checked" />
            <b>Twist = <span id="twist">0.0</span></b>
          </div>
          If checked, moving the mouse pointer "horizontally" over the canvas while holding down the mouse button 
          will change the amount of twist applied on the rendered shape. 
          Twisting is applied after scaling.
        </p>
      </div>
    </div>
  </body>
  
</html>
